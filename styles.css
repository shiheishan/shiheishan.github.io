/* ===== iOS 拟物，白色背景（无流动背景），删除线回调为半黑 ===== */
:root{
  --bg:#f5f5f7;
  --text:#1d1d1f;
  --muted:#6e6e73;
  --border:#d2d2d7;
  --card:#ffffffee;
  --accent:#34c759;
  --strike: rgba(0,0,0,.55);
  --radius:16px;
  --shadow:0 6px 16px rgba(0,0,0,.06);
  --gap:16px;
  --maxw:480px;
  --ink: var(--text);
}

@media (prefers-color-scheme: dark){
  :root{
    --bg:#0f1115;
    --text:#f2f2f7;
    --muted:#a1a1a6;
    --border:#2c2c2e;
    --card:#0f1115e6;
    --strike:rgba(255,255,255,.5);
  }
}

*{ box-sizing:border-box; }
html, body{ height:100%; }
body{
  margin:0; color:var(--text);
  font:16px/1.6 -apple-system,BlinkMacSystemFont,"SF Pro Display","SF Pro Text",system-ui,"Helvetica Neue",Segoe UI,Arial;
  background: var(--bg);
  overflow-x:hidden;
}

.app{ height:100dvh; display:grid; grid-template-rows:auto 1fr; gap:var(--gap);
      padding:var(--gap) var(--gap) calc(96px + env(safe-area-inset-bottom));
      max-width:var(--maxw); margin:0 auto; }

/* 时间卡片 */
.time-card{
  background: var(--card);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  border:1px solid var(--border);
  display:flex; align-items:center; justify-content:center;
  padding:var(--gap);
  font-weight:700; text-align:center;
}

.panel{ background:var(--card); border-radius:var(--radius); box-shadow:var(--shadow);
        display:flex; flex-direction:column; min-height:0; overflow:hidden; }
.panel__title{ position:sticky; top:0; z-index:1; padding:var(--gap);
              font-weight:700; border-bottom:1px solid var(--border); background:var(--card); }
.panel__body{ flex:1; min-height:0; overflow-y:auto; scrollbar-gutter:stable; padding:var(--gap); }
@supports not (scrollbar-gutter:stable){
  .panel__body{ overflow-y:scroll; padding-right:calc(var(--gap) + 8px); }
}
.donut{ position:fixed; left:50%; transform:translateX(-50%);
        bottom:calc(16px + env(safe-area-inset-bottom)); width:92px; height:92px;
        display:grid; place-items:center; }
.donut svg, .donut figcaption{ grid-area:1/1; }
.donut circle{ fill:none; stroke-width:12; }
.donut .track{ stroke:#e5e5ea; }
.donut .ring{ stroke:var(--accent); transform-origin:50% 50%; transform:rotate(-90deg);
               transition:stroke-dashoffset 200ms ease-out; }
@media (prefers-reduced-motion: reduce){
  .donut .ring{ transition:none; }
}
.donut figcaption{ font-weight:700; }

@media (prefers-reduced-motion: reduce){
  *{animation:none!important;transition:none!important;}
}

/* 内容布局 */
.content{ margin-top:18px; }

/* 学科卡片（回归白卡片风格） */
.subject{
  background: #fff;
  border:1px solid var(--border); border-radius:18px;
  box-shadow: 0 6px 16px rgba(0,0,0,.06), inset 0 1px 0 rgba(255,255,255,.4);
  padding:14px 16px; margin-bottom:14px;
  will-change:transform;
  transition:transform 220ms cubic-bezier(0.2,0,0,1), opacity 220ms;
}
.subject-title{ font-weight:700; font-size:18px; margin:2px 0 8px; letter-spacing:.2px; }
.tasks{ margin:0; padding:0; list-style:none; }

/* ===== 任务行（自定义勾选 + 渐进删除线 + 文字半透明） ===== */
@property --p{ syntax: '<number>'; initial-value: 0; inherits: false; }

.task{ display:flex; align-items:center; gap:12px; padding:10px 6px; border-radius:12px; position:relative; }
.task:hover{ background:linear-gradient(180deg, rgba(0,0,0,.04), transparent); }

.task input{ position:absolute; opacity:0; pointer-events:none; }

/* 自定义方框（iOS风） */
.checkbox{
  width:22px; height:22px; border-radius:8px; border:1px solid var(--border);
  background:linear-gradient(180deg,#fff,#f3f4f6);
  box-shadow:inset 0 1px 0 rgba(255,255,255,.8);
  display:inline-grid; place-items:center; flex:0 0 22px; position:relative; overflow:hidden;
}
.checkbox::after{
  content:""; position:absolute; left:5px; top:11px; width:12px; height:6px;
  border-left:3px solid var(--accent); border-bottom:3px solid var(--accent);
  transform: rotate(-45deg) scale(0); transform-origin: left bottom;
  transition: transform .28s cubic-bezier(.2,.9,.3,1.5);
}

/* 文本渐隐 + 删除线推进（回调为原来的方向/配色） */
.text{
  position:relative; font-size:16px; letter-spacing:.2px; line-height:1.4;
  color:transparent; -webkit-background-clip:text; background-clip:text;
  background-image: linear-gradient(90deg,
    rgba(0,0,0,.55) 0%,
    rgba(0,0,0,.55) calc((var(--p)*100% - 2%)),
    rgba(0,0,0,1) calc(var(--p)*100%),
    rgba(0,0,0,1) 100%
  );
  transition: --p .42s ease;
}
.text::after{
  content:""; position:absolute; left:0; right:0; top:50%; height:2px; border-radius:2px; background:var(--strike);
  transform: translateY(-50%) scaleX(var(--p)); transform-origin: left center; transition: transform .42s ease;
}

/* 状态联动 */
.task input:checked ~ .checkbox::after{ transform: rotate(-45deg) scale(1); }
.task input:checked ~ .text{ --p: 1; }
.task input:not(:checked) ~ .text{ --p: 0; }

/* 侧栏：甜甜圈卡片 */
.aside{ position:relative; background:#fff; border:1px solid var(--border); border-radius:18px; padding:18px;
  box-shadow: 0 6px 16px rgba(0,0,0,.08), inset 0 1px 0 rgba(255,255,255,.4); }
.aside h3{ margin:2px 0 12px; font-size:16px; font-weight:700; color:var(--muted); }


/* 完成屏 */
.done-screen{ position:absolute; inset:0; display:none; align-items:center; justify-content:center; text-align:center; padding:24px; }
.show-done .done-screen{ display:flex; }
.done-screen .card{ background:#fff; border:1px solid var(--border); border-radius:22px; padding:28px 22px; box-shadow:0 12px 26px rgba(0,0,0,.12), inset 0 1px 0 rgba(255,255,255,.5); }
.done-screen h1{ margin:0 0 6px; font-size:22px; }
.done-screen p{ margin:0; color:var(--muted); }

/* 小提示 */
.hint{ margin:10px 0 0; font-size:12px; color:var(--muted); }



/* ==== 布局调整：中间合并为一个大卡片 + 内部上下滑，底部甜甜圈 ==== */
:root{
  --container: min(760px, calc(100vw - 24px)); /* 手机两侧 12px 留白，桌面限宽 */
}

.wrap{
  display:flex; flex-direction:column; align-items:center; justify-content:flex-start;
  padding:20px 12px; min-height:100dvh;
}

/* 顶部日期卡与大卡片宽度统一 */
.date-card, .board{ width:var(--container); margin-left:auto; margin-right:auto; }

/* 大卡片整体样式（沿用原 subject 的拟物风） */
.board.card{
  background:#fff;
  border:1px solid var(--border); border-radius:22px;
  box-shadow: 0 6px 16px rgba(0,0,0,.06), inset 0 1px 0 rgba(255,255,255,.4);
  padding:16px;
  max-height: calc(100dvh - 260px); /* 留给上面的日期卡和下面的甜甜圈 */
  overflow-y:auto;
  scrollbar-gutter: stable;
}

/* 卡片里每个学科：去掉独立边框与阴影，做成分组 */
.board .subject{ background:transparent; border:0; box-shadow:none; margin:0; padding:16px 12px; }
.board .subject + .subject{ border-top:1px solid var(--border); }
.board .subject h2{ margin:0 0 8px; font-size:22px; line-height:1.3; }

/* 任务项间距微调，让更像系统列表 */
.board .task{ padding:10px 2px; }

/* 甜甜圈居下，尺寸自适应 */

/* 隐藏动画 canvas，避免占位撑开布局 */
#ion-canvas{
  display:none;
  position:absolute;
  top:0;
  left:0;
}
